<!DOCTYPE html>
<html>

<head>

    <!--<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">-->
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <title><!--(auto-fill by runme.js--></title>

    <!-- ChiliPeppr is based on bootstrap CSS. -->
    <!--<link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">-->

    <!-- Customized version of require.js for ChiliPeppr. Please see require.js docs for how
    ChiliPeppr's dependency system works as it's based on require.js. -->
    <!--<script type='text/javascript' src="//i2dcui.appspot.com/js/require.js"></script>-->
    <!--<script type='text/javascript' src="widgets/require.js"></script>-->

    <!-- widget.css DON'T REMOVE -->
    <style type='text/css'>
        /* widget.css will get inlined here by runme.js. don't remove this comment or inlining will fail. */
    </style>
    <link rel="stylesheet" type="text/css" href="widgets/visor-camara/widget.css">
    <!-- DON'T REMOVE end widget.css -->

    <!-- widget.js DON'T REMOVE -->
    <script type='text/javascript'>
        //<![CDATA[
        /* widget.js will get inlined here by runme.js. don't remove this comment or inlining will fail. */
        //]]>
    </script>
    <script type='text/javascript' src="widgets/visor-camara/widget.js"></script>
    <!-- DON'T REMOVE end widget.js -->

</head>

<body>
    <div id="com-chilipeppr-widget-cam" class="card ">
        <div class="card-header" style="padding: 0px;">

            <div class="btn-toolbar float-xs-right" role="toolbar">
                <!-- <div class="btn-group">
                    <div class="dropdown">
                        <button type="button" class="btn btn-sm btn-info dropdown-toggle" data-toggle="dropdown">
                            <span class="fa fa-camera"></span>
                            <span class="caret" style="font-size:10px; margin-left:-2px; xmargin-right:-4px;"></span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-right" role="menu">
                            <li><a class="one-col" href="javascript:">1 Column Layout</a></li>
                            <li><a class="two-col" href="javascript:">2 Column Layout</a></li>
                            <li><a class="three-col" href="javascript:">3 Column Layout</a></li>
                            <li role="separator" class="dropdown-divider"></li>
                            <li><a class="" href="javascript:"><span class="fa fa-refresh"></span> Refresh Cam List</a></li>
                            <li role="separator" class="dropdown-divider"></li>
                            <li role="presentation" class="dropdown-header server-192-168-1-35">ws://192.168.1.35&nbsp;raspi3</li>
                            <li><a class="" href="javascript:">
                                <div src="" class="cam-img" style="background-image:url('cam-raspicam3.png');"></div>
                                Raspicam
                                <br><span style="font-size:10px;">2592×1944, 1920×1080, 1296×972,
                                1296×730, 640x480. 250ma</span>
                            </a></li>
                            <li><a class="" href="javascript:">
                                <div src="" class="cam-img" style="background-image:url('cam-cubeternet.png');"></div>
                                USB Cubeternet GL-UPC822 UVC WebCam<br>
                                <span style="font-size:10px;">640x480, 320x240. 200ma</span>
                            </a></li>
                            <li><a class="" href="javascript:">
                                <div src="" class="cam-img" style="background-image:url('cam-endoscope.png');"></div>
                                USB Silicon Motion, Inc. - Taiwan (formerly Feiya Technology Corp.)
                                <br><span style="font-size:10px;">640x480, 320x240. 500ma</span>
                            </a></li>
                            <li role="presentation" class="dropdown-header server-192-168-1-37">ws://192.168.1.37&nbsp;raspi3-cam</li>
                            <li><a class="disabled" href="javascript:" disabled>
                                <div src="" class="cam-img" style="background-image:url('cam-raspicam3.png');"></div>
                                Raspicam (disabled)
                                <br><span style="font-size:10px;">2592×1944, 1920×1080, 1296×972,
                                1296×730, 640x480. 250ma</span>
                            </a></li>
                            <li><a class="" href="javascript:">
                                <div src="" class="cam-img" style="background-image:url('cam-lifecam.png');"></div>
                                USB Microsoft Corp. LifeCam HD-3000</a></li>
                            <li><a class="" href="javascript:">
                                <div src="" class="cam-img" style="xbackground-image:url('cam-endoscope.png');"></div>
                                USB GEMBIRD
                                <br><span style="font-size:10px;">640x480, 320x240. 500ma</span>
                            </a></li>

                        </ul>
                    </div>
                </div> -->

                <div class="btn-group">
                    <button type="button" class="btn btn-sm btn-info btn-stopstreaming" id="stopcam" data-delay="1000"
                        data-animation="true" data-placement="auto" data-container="body" data-trigger="hover"
                        data-title="Stop Streaming" data-content="Stop streaming the video feed from your server.">
                        <span class="fa fa-times-circle"></span>
                    </button>
                    <button type="button" class="btn btn-sm btn-info btn-startstreaming" id="startcam" data-delay="1000"
                        data-animation="true" data-placement="auto" data-container="body" data-trigger="hover"
                        data-title="Start Streaming" data-content="Start streaming the video feed from your server.">
                        <span class="fa fa-check-circle"></span>
                    </button>
                    <!--<button type="button" class="btn btn-sm btn-info btn-preferences" data-delay="1000"
                        data-animation="true" data-placement="auto" data-container="body" data-trigger="hover"
                        data-title="Prefrences" data-toggle="modal" data-target="#prefcam" data-content="Set or select preferences for this widget.">
                        <span class="fa fa-cog"></span>
                    </button> -->
                </div>
                <!-- <div class="btn-group">
                    <button type="button" class="btn btn-sm btn-info hidebody"><span class="fa fa-chevron-up"></span>
                    </button>
                </div>
                <div class="btn-group">
                    <div class="dropdown">
                        <button type="button" class="btn btn-sm btn-info dropdown-toggle" data-toggle="dropdown"><span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                    </div>
                </div> -->
            <!-- </div> <span class="card-header" data-toggle="popover">Cam</span> <span style="font-size:9px;" class="fb-build">v1</span> -->

        </div>
        <div class="card-block" id="cam" style="padding: 0px;">
              <div id="camara_live">
                  <!--<img src= "http://200.3.186.219:8080/?action=stream" width="100%" onerror="this.src='img/camera-off-icon.png';" />-->
                  <img src= "http://181.45.222.48:8080/?action=stream" width="100%" height="300px"  onerror="this.src='img/camera-off-icon.png';" />
              </div>
        </div>

        <div class="modal fade settings-modal" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">WebRTC Settings</h4>
                    </div>
                    <div class="modal-body">
                        <form class="" role="form">
                            <p></p>

                            <input class="hidden" required type="text" id="signalling_server"
                                value="192.168.1.16:8889"
                                title="<host>:<port>, default address is autodetected"/>
                            <input class="hidden" type="text" id="ice_servers" value=""
                                title="array of RTCIceServer objects as valid JSON string"/>

                            <label>
                                <input type="checkbox" xonclick="remote_hw_vcodec_selection();"
                                class="remote_hw_vcodec" name="remote_hw_vcodec"
                                value="remote_hw_vcodec"
                                title="try to force the use of the hardware codec for both encoding and decoding if enabled and supported">
                                Force use of hardware codec for
                            </label>
                            <select class="remote_vformat" name="remote_vformat"
                            xonclick="remote_hw_vcodec_format_selection();"
                            title="available resolutions and frame rates at the min., max. and start configured bitrates for adaptive streaming which will be scaled from the base 720p 30fps">
                                <option value="10" selected="selected">320x240 30 fps</option>
                                <option value="20">352x288 30 fps</option>
                                <option value="30" xselected="selected">640x480 30 fps</option>
                                <option value="40">960x720 30 fps</option>
                                <option value="50">1024x768 30 fps</option>
                                <option value="60">1280x720 30 fps, kbps min.1500 max.4000 start2000</option>
                                <option value="70">1280x768 30 fps</option>
                                <option value="80">1280x960 30 fps</option>
                                <option value="90">1600x768 30 fps</option>
                                <option value="100">1920x1072 15 fps</option>
                            </select>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <!-- /.modal -->

        <div class="modal fade preferences-window" id="prefcam" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                            <h4 class="modal-title">Camera  Options</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

                    </div>
                    <div class="modal-body">
                        <form class="" role="form">
                            <p>The Camera widget will get a "motion" MJPEG Stream from your url. Please install motion and input the complete url to the MJPEG Stream.</p>

                            <div class="input-group" style="width:200px;">
                                <div class="input-group-addon"style="    margin-top: 5px;margin-right: 5px;">url</div>
                                <input type="string" class="form-control mjpeg-url" placeholder="url for mjpeg stream" value="http://127.0.0.1:9081" />

                            </div>
                            </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <!-- /.modal -->

    </div>


<!--<script>
    $.get("http://200.3.186.219:8080/stream_simple.html", function(htmlextern){
    $("#camara_live").html(htmlextern);
    });
</script>-->
<script>
    $(document).ready(function() {
        var socket = io.connect('http://66.97.46.179:3003/', {
            rejectUnauthorized: false
        });
        $("#startcam").click(function() {

            socket.emit('control message', "prender_camara");

            return true;
        });

        $("#stopcam").click(function() {

            socket.emit('control message', "apagar_camara");

            return true;
        });

        // socket.on('control message', function(msg){
        //     // msg=camara_prendida;
        //     if(msg =='camara_prendida'){
        //     window.location.reload();
        //         //$("#com-chilipeppr-widget-cam").load(location.href + " #ccom-chilipeppr-widget-cam>*", "");
        //         // $('#com-chilipeppr-widget-cam').load(location.href + "#com-chilipeppr-widget-cam");
        //         // $("#com-chilipeppr-widget-cam").load("widgets.html");
        //     }
        //     if(msg =='camara_apagada'){
        //         window.location.reload();
        //     }
        //
        // });


    });
</script>
</body>

</html>
